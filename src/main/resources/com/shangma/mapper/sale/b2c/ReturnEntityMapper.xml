<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.shangma.mapper.sale.b2c.ReturnEntityMapper">
    <select id="findAllOrder" resultType="com.shangma.entity.sale.b2c.ReturnEntityManage">
        select * from t_b2c_sales_return_entity_manage
    </select>
    <select id="findBySearch" parameterType="com.shangma.entity.sale.b2c.ReturnEntityManage" resultType="com.shangma.entity.sale.b2c.ReturnEntityManage">
        select t1.order_id,t1.order_type,t1.order_action,
        t1.business_type,t1.payment,t1.distribution_mode,
        t1.order_status
        from t_b2c_sales_return_entity_manage t1,t_b2c_customer t2
        where t1.customer_id=t2.id
        <if test="orderId != null and orderId != ''">
            and t1.order_id like '%${orderId}%'
        </if>
        <if test="customerName != null and customerName != ''">
            and t2.customer_name like '%${customerName}%'
        </if>
        <if test="customerAddress != null and customerAddress != ''">
            and t2.customer_address like '%${customerAddress}%'
        </if>
        <if test="rejectionReason != null and rejectionReason != ''">
            t1.rejection_reason like '%${rejectionReason}%'
        </if>
        <if test="timeFrom01 !=null">
            and t1.order_date &gt;= '${timeFrom01}'
        </if>
        <if test="timeTo01 != null">
            and t1.order_date &lt;= '${timeTo01}'
        </if>
        <if test="timeFrom02 !=null">
        and t1.order_date &gt;= '${timeFrom02}'
        </if>
        <if test="timeTo02 != null">
            and t1.order_date &lt;= '${timeTo02}'
        </if>
    </select>
    <select id="findById" parameterType="Long" resultType="com.shangma.entity.sale.b2c.ReturnEntityManage">
        select * from t_b2c_sales_return_entity_manage where order_id = #{orderId}
    </select>
    <select id="findCustomer" parameterType="Long" resultType="com.shangma.entity.sale.b2c.Customer">
        select * from t_b2c_customer where id=#{id}
    </select>
    <select id="findGoodsById" parameterType="Long" resultType="com.shangma.entity.sale.b2c.OrderGoods">
        select * from t_b2c_order_goods where order_id = #{orderId}
    </select>
    <insert id="addReturnRecord" parameterType="com.shangma.entity.sale.b2c.ReturnEntityManage">
        INSERT INTO `shangma-erp`.`t_b2c_sales_return_entity_record`
        ( `order_id`, `order_type`, `order_action`, `business_type`,
         `payment`, `distribution_mode`, `order_status`, `order_date`,
          `customer_id`, `rejection_reason`, `rejection_date`,
          `signoff_time`, `creator`, `creat_date`, `tracking_number`)
           VALUES ( ${orderId}, '${orderType}', '${orderAction}', '${businessType}', '${payment}',
           '${distributionMode}', '${orderStatus}', '${orderDate}', ${customerId}, '${rejectionReason}',
           '${rejectionDate}', '${signoffTime}', '${creator}', NOW(), '${trackingNumber}');
    </insert>
    <delete id="deleteByOrderId" parameterType="Long">
        DELETE from t_b2c_sales_return_entity_manage where order_id=#{orderId}
    </delete>
</mapper>