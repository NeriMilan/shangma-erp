<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.shangma.mapper.sale.b2c.SalesStatisticsMapper">
    <select id="getRank" resultType="com.shangma.entity.sale.b2c.SalesStatistics">
        select t1.good_name,t5.type_name,t4.brand_name,t3.goods_model,t3.goods_color,SUM(t1.good_count) total_count
            FROM t_b2c_order_goods t1,t_b2c_sales_order t2,t_goods t3,t_goods_brand t4,t_goods_type t5
            where t1.order_id=t2.order_id and t1.good_id=t3.id
            and t3.type_id=t5.id and t3.brand_id=t4.id
            GROUP BY good_id
            ORDER BY SUM(good_count) DESC
    </select>

<!--    根据传来的对象进行动态查询-->
    <select id="getRankBySearch" parameterType="com.shangma.entity.sale.b2c.SalesStatistics" resultType="com.shangma.entity.sale.b2c.SalesStatistics">
        select t1.good_name,t5.type_name,t4.brand_name,t3.goods_model,t3.goods_color,SUM(t1.good_count) total_count
            FROM t_b2c_order_goods t1,t_b2c_sales_order t2,t_goods t3,t_goods_brand t4,t_goods_type t5
            where t1.order_id=t2.order_id
            and t1.good_id=t3.id and t3.type_id=t5.id
            and t3.brand_id=t4.id

                <if test="goodName != null and goodName != ''">
                    and t1.good_name like '%${goodName}%'
                </if>
                <if test="typeName != null and typeName != ''">
                    and t5.type_name like '%${typeName}%'
                </if>
                <if test="brandName != null and brandName != ''">
                    and t4.brand_name like '%${brandName}%'
                </if>
                <if test="goodsColor != null and goodsColor != ''">
                    and t3.goods_color like '%${goodsColor}%'
                </if>
                <if test="timeFrom != null">
                    and t2.order_date &gt;= '${timeFrom}'
                </if>
                <if test="timeTo != null">
                    and t2.order_date &lt;= '${timeTo}'
                </if>

            GROUP BY good_id ORDER BY SUM(good_count) DESC
    </select>
</mapper>